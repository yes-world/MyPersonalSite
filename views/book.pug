doctype html
html
    head
        title Книга - yes.world
        meta(charset="UTF-8")
        meta(name="viewport" content="width=device-width, initial-scale=1")
        link(rel="stylesheet" href="/css/bootstrap.css")
        link(rel="stylesheet" href="/css/style.css")
        script(src="/js/jquery-3.5.1.js")
        script(src="/js/bootstrap.bundle.js")
        if admin
            script(src="/js/jquery.validate.min.js")
        script (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)}; m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)}) (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym"); ym(65130928, "init", { clickmap:true, trackLinks:true, accurateTrackBounce:true, webvisor:true });
        noscript
            div
                img(src="https://mc.yandex.ru/watch/65130928" style="position:absolute; left:-9999px;" alt="")
    body
        if admin
            div(class="modal fade" id="changeBookMeta" tabindex="-1" role="dialog" aria-labelledby="changeBookMetaLabel" aria-hidden="true")
                div(class="modal-dialog" role="document")
                    div(class="modal-content")
                        div(class="modal-header")
                            h5(class="modal-title" id="changeBookMetaLabel") Редактирование мета-данных
                            button(type="button" class="close" data-dismiss="modal" aria-label="Close")
                                span(aria-hidden="true") &times;
                        div(class="modal-body")
                            div(class="container-fluid")
                                div(class="row")
                                    div(class="col-12")
                                        form(action="/changeBookMeta" id="changeBookMetaForm" method="post")
                                            div(class="form-group")
                                                label(for="inCashName") Cash name:
                                                input(name="cashName" type="text" class="form-control" id="inCashName" value=bookMeta.cashName readonly)
                                            div(class="form-group")
                                                label(for="inAuthor") Автор:
                                                input(name="author" type="text" class="form-control" id="inAuthor" value=bookMeta.author)
                                            div(class="form-group")
                                                label(for="inBookTitle") Название:
                                                input(name="bookTitle" type="text" class="form-control" id="inBookTitle" value=bookMeta.bookTitle)
                                            div(class="form-group")
                                                label(for="inCity") Город:
                                                input(name="city" type="text" class="form-control" id="inCity" value=bookMeta.city)
                                            div(class="form-group")
                                                label(for="inYear") Год:
                                                input(name="year" type="text" class="form-control" id="inYear" value=bookMeta.year)
                                            div(class="form-group")
                                                label(for="inDate") Дата:
                                                input(name="date" type="text" class="form-control" id="inDate" value=bookMeta.date)
                                            div(class="form-group")
                                                label(for="inCoverpage") Обложка:
                                                input(name="coverpage" type="text" class="form-control" id="inСoverpage" value=bookMeta.coverpage)
                                            div(class="form-group")
                                                label(for="inAnnotation") Аннотация:
                                                textarea(name="annotation" class="form-control" id="inAnnotation" rows="5")= bookMeta.annotation
                                            div
                                                button(type="submit" class="btn btn-primary") Сохранить
                                                button(type="button" class="btn btn-secondary ml-2" data-dismiss="modal") Отмена

        div(class="modal fade" id="forAuthors" tabindex="-1" role="dialog" aria-labelledby="forAuthorsLabel" aria-hidden="true")
            div(class="modal-dialog" role="document")
                div(class="modal-content")
                    div(class="modal-header")
                        h5(class="modal-title" id="forAuthorsLabel") Правообладателям
                        button(type="button" class="close" data-dismiss="modal" aria-label="Close")
                            span(aria-hidden="true") &times;
                    div(class="modal-body")
                        div(class="container-fluid")
                                div(class="row")
                                    div(class="col-12")
                                        p Если этот сайт нарушает ваши авторские права, просьба написать нам об этом. Мы приносим вам извинения, а все произведения, нарушающие права, будут удалены с сайта.
                    div(class="modal-footer")
                        a(class="btn btn-primary" href="/contacts" role="button") Сообщить о нарушении
                        button(type="button" class="btn btn-secondary" data-dismiss="modal") Закрыть

        nav(class="navbar navbar-expand-md navbar-dark sticky-top" style="background-color: #910083;")
            div(class="container")
                a(class="navbar-brand" href="/") yes.world
                button(class="navbar-toggler" type="button" data-toggle="collapse" data-target="#hatMenu" aria-controls="hatMenu" aria-expanded="false" aria-label="Открыть")
                    span(class="navbar-toggler-icon")

                div(class="collapse navbar-collapse justify-content-md-end" id="hatMenu")
                    ul(class="navbar-nav")
                        li(class="nav-item pr-md-3")
                            button(type="button" class="btn btn-warning" data-toggle="modal" data-target="#forAuthors" id="butForAuthors") Правообладателям
                        li(class="nav-item pr-md-3")
                            a(class="nav-link" href="/") Главная
                        li(class="nav-item pr-md-3")
                            a(class="nav-link" href="https://github.com/yes-world" target="_blank") GitHub
                        li(class="nav-item dropdown pr-md-3")
                            a(class="nav-link dropdown-toggle" href="#" id="social" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false") Соц. сети
                            div(class="dropdown-menu" aria-labelledby="social")
                                a(class="dropdown-item" href="https://vk.com/yes.world" target="_blank") ВКонтакте
                                a(class="dropdown-item" href="https://www.instagram.com/__yes.world__/" target="_blank") Instagram
                                a(class="dropdown-item" href="https://vm.tiktok.com/3LprqS/" target="_blank") TikTok
                                a(class="dropdown-item" href="https://music.yandex.ru/users/DamirSabitov2001/playlists/3" target="_blank") Плейлист на Яндекс.Музыке
                        li(class="nav-item pr-md-3")
                            a(class="nav-link" href="/contacts") Контакты
                        if login
                            li(class="nav-item dropdown")
                                a(class="btn btn-outline-light dropdown-toggle" href="#" id="profileMenu" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false") #{username}
                                div(class="dropdown-menu" aria-labelledby="profileMenu")
                                    a(class="dropdown-item" href="/profile") Профиль
                                    div(class="dropdown-divider")
                                    a(class="dropdown-item" href="/logout") Выйти
                        else
                            li(class="nav-item")
                                a(class="btn btn-outline-light" href="/login?page=%2Fbooks%2Fbook%2F" + bookMeta.cashName) Гость

        div(class="container")
            div(class="row py-4")
                if admin
                    div(class="col-12 d-flex")
                        a(class="btn btn-info" href="/books") Назад
                        button(type="button" class="btn btn-secondary ml-3" data-toggle="modal" data-target="#changeBookMeta" id="butChangeBookMeta") Редактировать
                else
                    div(class="col-12")
                        a(class="btn btn-info" href="/books") Назад
            div(class="row")
                div(class="col-12")
                    p(class="mh2") #{bookMeta.bookTitle}
                    p(class="mh3") #{bookMeta.author}
            div(class="row")
                div(class="col-md-4")
                    if bookMeta.coverpage
                        img(class="img-fluid mb-4 shadow" src="/img/" + bookMeta.cashName + "/" + bookMeta.coverpage)
                    else
                        p Обложка отсутствует
                div(class="col-md-8")
                    if login
                        p
                            a(class="btn btn-success btn-lg mt-3" role="button" href="/books/read/" + bookMeta.cashName target="_blank") Читать
                    else
                        div(class="row pt-3 mb-3")
                            div(class="col-12 d-flex align-items-center")
                                a(class="btn btn-primary btn-lg" role="button" href="/login?page=%2Fbooks%2Fbook%2F" + bookMeta.cashName) Войти
                                div(class="pl-3 font-weight-light") Чтение доступно только авторизованным пользователям
                    p= bookMeta.annotation
                    if bookMeta.city
                        if bookMeta.year
                            p
                                em #{bookMeta.city} #{bookMeta.year}
                        else
                            p
                                em Город: #{bookMeta.city}
                    else
                        if bookMeta.year
                            p
                                em Год: #{bookMeta.year}
                    if bookMeta.date
                        p
                            em #{bookMeta.date}
        
        if admin
            script(src="/js/formValidation.js")